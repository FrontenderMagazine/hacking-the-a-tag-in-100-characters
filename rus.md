# Взлом тега \<a\> в 100 символов

Совсем недавно я обнаружил, что JavaScript позволяет **изменять атрибут *href*
тега \<a\> *после* того, как вы кликнете по нему**. Это может показаться не
таким уж серьезным на первый взгляд, но будьте уверены, так покупатели могут
попасться на крючок и передать свои личные данные мошенникам.

Давайте я покажу вам пример. <a href="http://www.paypal.co.uk/"
onclick="this.href='http://bit.ly/141nisR'">Эта ссылка должна привести вас на
PayPal</a>.

Вы увидите, что она **не ведет** на PayPal (*кроме Opera, где это поведение,
похоже, было исправлено*). Это происходит потому, что когда вы кликнули по
ссылке, я запустил код, который изменил атрибут *href*, и браузер неожиданно
повел меня по *новой ссылке*. **такого быть не должно.** Посетители сайта (и,
возможно, наиболее технически подкованные люди) могут и будут считать, что то
место, где они оказались, может быть обычной переадресацией, в данном случае,
с PayPal. В прошлом году PayPal на протяжении месяцев перенаправлял
пользователей с главной страницы их британского сайта на paypal-
business.co.uk. Мне кажется, что посетители сайтов были приучены к
перенаправлениям, и если этот изъян будет использоваться именно так, то это
может представлять собой реальную угрозу <s>того, что я называю Фишинг
2.0</s>.

Давайте взглянем на JavaScript:

    // Uncompressed   
    var links = document.links;   
    for(i in links) {
      links[i].onclick = function(){ this.href = 'http://bit.ly/141nisR'; };
    }

    // Compressed (was 100; now 67 characters exc. the link)   
    // Thanks to sgoel from HN
    o=document.links;for(i in o){o[i].onclick=function(){this.href='//bit.ly/141nisR'}}

Также этот прием сложно отследить. Практически *все*, кто использует
JavaScript/jQuery будут вешать обработчик на тег <a>, а это уже не
исправляется простым удалением каждой функции onclick у <a>. Вполне реально
обернуть вышеописанный код в *setTimeout*, чтобы обойти любое решение этой
проблемы. Любой хоть наполовину достойный хакер может создать вирус или
встраиваемый JavaScript-код, который внедрится в ваш код бок о бок с другим
ПО. Поскольку обновлять JavaScript (особенно встраиваемый) невероятно просто,
я могу сказать, что такие инструменты, как McAfeeSecure и PhishTank не смогут
поспевать за зараженными веб-сайтами.

<s>Поскольку эта опция не приносит реальной пользы, я прошу Консорциум
Всемирной Паутины (W3C) и производителей лидирующих браузеров отключить
возможность изменения атрибута *href* **после срабатывания события onclick**.
Это простейший изъян интерпретатора, и несмотря на то, что такое поведение
кажется кому-то нормальным, оно может быть использовано в дурных целях. Я
осознаю, что Google и подобные ему сайты используют такое поведение, но если
мы собираемся делать Сеть безопаснее, то мы не можем разрешить такому
простому  изъяну существовать. Есть альтернативы (например, использование
подлинных ссылок без их маскировки), и поэтому эта возможность должна быть
отключена. Она не стоит того, чтобы Интернет-пользователи становились
жертвами мошенничества и воровства</s>

*Обновление (19.03)* — Моя новая просьба состоит в том, чтобы **предупреждать
пользователей о том, что адрес ссылки изменяется на другой домен после клика**
([+1 abididea][1]). Такие сайты как Google и Facebook могут продолжать
нормально работать, пока они используют один и тот же домен, Интернет в
безопасности, а возможность фишинга устранена. Все остаются в выигрыше (кроме
самих фишеров, конечно!). Мне **нужна ваша помощь**, чтобы лидирующие браузеры
ввели это исправление как можно скорее. Давайте лишим мошенников еще одного
способа обманывать Интернет-пользователей.

*Обновление (19.03)* — Я предложил исправление в Firefox, жду ответа.

[1]: http://www.reddit.com/user/abadidea
